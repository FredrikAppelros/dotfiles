#!/bin/sh

DOTFILESDIR="$(readlink -e $(dirname $0))"

# Run preinstall scripts
for file in $(find $DOTFILESDIR -name preinstall.sh | xargs); do
  sh -c "$file"
done

# Install packages
sudo apt-get update && sudo apt-get install -y $(cat packages | xargs)

# Initialize submodules
git submodule update --init --recursive

# Run install scripts
for file in $(find $DOTFILESDIR -name install.sh | xargs); do
  sh -c "$file"
done

# Create symbolic links
for target in $(find $DOTFILESDIR -name "*.symlink"); do
  link="$HOME/.$(basename ${target%.*})"
  ln -s $target $link
done
